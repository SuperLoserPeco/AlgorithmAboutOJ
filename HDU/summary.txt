后缀自动机 
    4622

数位dp
    2089